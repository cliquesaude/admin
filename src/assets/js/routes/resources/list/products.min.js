!function(){"use strict";var m,f,t=window.tabId,a=window.Tabs[t],v=$("#products-list-container"),b=v.find("#products-list-results"),h=window.i18n,e=function(){m=a.data,f=m.hits.hits.map(function(t){return Object.assign({_id:t._id},t._source)})};if(e(),f.length){var l="",g=[],n=function(){var t;""!==l?(t={bool:{must:{multi_match:{query:l,fields:["name","keywords"]}}}},g.length&&(t.bool.filter=g)):g.length&&(t={bool:{filter:g}});v.addClass("ajax"),a.load(function(){e(),i()},t)},_=$("<div />"),r=$("<div />"),y=$("<form />",{action:"javascript:;",submit:n,html:['<div class="form-group"><input class="form-control text-monospace" placeholder="SKU" type="text" name="sku" data-filter="term"/></div>',_,'<label class="i18n"><span data-lang="en_us">Price</span><span data-lang="pt_br">Preço</span></label>',r,'<div class="flexbox"><div class="form-group"><input class="form-control" type="tel" name="price" data-opt="gte" data-filter="range" data-is-number="true" data-money="true"/><small class="form-text i18n"><span data-lang="en_us">Minimun</span><span data-lang="pt_br">Mínimo</span></small></div><div class="form-group"><input class="form-control" type="tel" name="price" data-opt="lte" data-filter="range" data-is-number="true" data-money="true"/><small class="form-text i18n"><span data-lang="en_us">Maximum</span><span data-lang="pt_br">Máximo</span></small></div></div>']}),s=$("#qvx");s.find("#qvx-title").text(h({en_us:"Filter products",pt_br:"Filtrar produtos"})),s.find("#qvx-body").html(y),s.find("#qvx-footer").html($("<button />",{class:"btn btn-block btn-success",click:function(){n(),quickview.close(s)},html:h({en_us:"Apply filters",pt_br:"Aplicar filtros"})}));var i=function(){for(var t=[],a=0;a<f.length;a++){var e,l=f[a];e=l.price?formatMoney(l.price,l.currency_id):h({en_us:"Undefined price",pt_br:"Preço indefinido"});var n=$("<div />",{class:"col",html:'<a href="/'+window.location.hash+"/"+l._id+'">'+l.name+'</a><div class="item-price">'+e+'</div><div class="custom-controls-stacked"><div class="custom-control custom-checkbox"><input type="checkbox" class="custom-control-input"><label class="custom-control-label text-monospace">'+l.sku+"</label></div></div>"});t.push(n)}b.html($("<div />",{class:"row row-products",html:t})),_.html("");var r={brands:{label:h({en_us:"Brands",pt_br:"Marcas"})},categories:{label:h({en_us:"Categories",pt_br:"Categorias"})}},s=m.aggregations;for(var i in r)if(r.hasOwnProperty(i)&&s.hasOwnProperty(i)){var o=r[i],c=s[i].buckets,d="";for(a=0;a<c.length;a++){var u=c[a].key;d+='<option value="'+u+'" data-subtext="('+c[a].doc_count+')">'+u+"</option>"}var p=$("<select />",{multiple:!0,"data-live-search":!0,class:"form-control",name:i+".name",html:d});_.prepend($("<div />",{class:"form-group selectpicker-default",html:p})),p.selectpicker({style:"btn-light",noneSelectedText:o.label,windowPadding:70})}v.removeClass("ajax"),handleInputs(y,function(t,a){var e=t.attr("name"),l=t.data("opt"),n=t.data("filter")||"terms",r=t.val();Array.isArray(r)?r.length||(r=null):t.data("is-number")?r=stringToNumber(r):"number"===t.attr("type")?r=parseFloat(r):""===(r=r.trim())&&(r=null);for(var s=0;s<g.length;s++){var i=g[s][n];if(i&&i.hasOwnProperty(e))return void(l?null!==r?i[e][l]=r:(delete i[e][l],Object.keys(i[e]).length||g.splice(s,1)):null!==r?i[e]=r:g.splice(s,1))}if(null!==r){var o={};o[n]={},l?(o[n][e]={},o[n][e][l]=r):o[n][e]=r,g.push(o)}})},o=v.find("#search-products"),c=o.find("input");c.attr("placeholder",h({en_us:"Polo Shirt",pt_br:"Camisa Polo"})),o.submit(function(){l=c.val().trim(),n()}),i()}}();