/*!
 * Copyright 2018 E-Com Club
 */
!function(){"use strict";var a=window.tabId,b=window.Tabs[a],c=window.i18n;b.continue=function(){var d=b.$form,e=randomObjectId(),f=0,g=$("#"+a+"-grids-list"),h='<div class="row"><div class="col-6"><div class="input-group"><div class="input-group-prepend"><button class="btn btn-light" type="button"><i class="fa fa-trash"></i></button></div><input class="form-control" type="text" name="grid" placeholder="'+c({en_us:"Size",pt_br:"Tamanho"})+'"></div></div><div class="col-6 hidden option-block"><div class="input-group"><input class="form-control" type="text" name="option" placeholder="GG"><div class="input-group-append"><button class="btn btn-light" type="button"><i class="fa fa-plus"></i></button></div></div></div></div>',i=!0,j=function(b){var c=$("<li />",{html:h});g.append(c);var d=c.find('input[name="grid"]'),e=c.find(".option-block"),f=e.find('input[name="option"]'),j=!0,k=i;d.keyup(function(b){switch(b.which){case 9:case 13:$(this).trigger("change");break;default:""!==$(this).val()?j&&(e.fadeIn(),j=!1,k&&$("#"+a+"-add-option-header").fadeIn()):j||(e.fadeOut(),j=!0,k&&$("#"+a+"-add-option-header").fadeOut())}}).change(function(){""!==$(this).val()?f.focus():f.val("")}),k&&($("#"+a+"-grids-list-header").slideDown(),i=!1),c.slideDown(400,function(){b||d.focus()})};$("#"+a+"-add-grid").click(function(){j()}),$("#"+a+"-random-sku").click(function(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=0;c<3;c++)a+=b.charAt(Math.floor(Math.random()*b.length));a+=randomInt(1e4,99999),$(this).closest(".input-group").find("input").val(a).trigger("change")}),setTimeout(function(){var a=function(a,b){var c=function(a){return JSON.stringify({_id:a,name:b})},d=$("<option />",{text:b,selected:!0,value:c(objectIdPad(e,""+f))});a.append(d).selectpicker("refresh").trigger("change"),f++;var g=a.attr("name"),h=function(b,e){b||(d.val(c(e._id)),a.trigger("change"))};window.callApi(g+".json","POST",h,{name:b})};d.find('select[name="brands"],select[name="categories"]').each(function(){var b=$(this).prev(".dropdown-menu");if(b.length){var d=$(this);b.find(".bs-searchbox input").keydown(function(){var e=$(this);setTimeout(function(){var f=b.find(".dropdown-menu > .no-results");if(f.length){var g=$("<button />",{class:"btn btn-outline btn-secondary btn-sm btn-block",type:"button",html:'<i class="fa fa-plus"></i> '+c({en_us:"Add",pt_br:"Adicionar"}),click:function(){a(d,e.val())}});f.html(g)}},300)})}})},400),b.formSetup()}}();