!function(){"use strict";var k,C,t=window.tabId,M=window.Tabs[t],q=$("#products-list-container"),P=q.find("#products-list-results"),j=q.find("#load-products"),A=window.i18n,e=function(){k=M.data,C=k.hits.hits.map(function(t){return Object.assign({_id:t._id},t._source)})};if(e(),C.length){var s="",O=[],I=0,S=0,n={},a=function(t){var a;""!==s?(a={bool:{must:{multi_match:{query:s,fields:["name","keywords"]}}}},O.length&&(a.bool.filter=O)):O.length&&(a={bool:{filter:O}});q.addClass("ajax"),t?I++:I=0,M.load(function(){e(),l()},a,n,I)};j.click(function(){a(!0)});var N=$("<div>"),F=$("<form>",{action:"javascript:;",submit:a,html:['<div class="form-group"><input class="form-control text-monospace" placeholder="SKU" type="text" name="sku" data-filter="term"/></div>',N,'<label class="i18n"><span data-lang="en_us">Price</span><span data-lang="pt_br">Preço</span></label><div class="flexbox"><div class="form-group"><input class="form-control" type="tel" name="price" data-opt="gte" data-filter="range" data-is-number="true" data-money="true"/><small class="form-text i18n"><span data-lang="en_us">Minimun</span><span data-lang="pt_br">Mínimo</span></small></div><div class="form-group"><input class="form-control" type="tel" name="price" data-opt="lte" data-filter="range" data-is-number="true" data-money="true"/><small class="form-text i18n"><span data-lang="en_us">Maximum</span><span data-lang="pt_br">Máximo</span></small></div></div><label class="i18n"><span data-lang="en_us">Quantity</span><span data-lang="pt_br">Quantidade</span></label><div class="flexbox"><div class="form-group"><input class="form-control" type="number" name="quantity" data-opt="gte" data-filter="range" data-is-number="true"/><small class="form-text i18n"><span data-lang="en_us">Minimun</span><span data-lang="pt_br">Mínimo</span></small></div><div class="form-group"><input class="form-control" type="number" name="quantity" data-opt="lte" data-filter="range" data-is-number="true"/><small class="form-text i18n"><span data-lang="en_us">Maximum</span><span data-lang="pt_br">Máximo</span></small></div></div>']}),r=function(){O=[],a()};q.find("#clear-products-filters").click(r);var i=$("#qvx");i.find("#qvx-title").text(A({en_us:"Filter products",pt_br:"Filtrar produtos"})),i.find("#qvx-body").html(F),i.find("#qvx-footer").html([$("<button>",{class:"btn btn-success mr-2",click:function(){a(),quickview.close(i)},html:A({en_us:"Apply filters",pt_br:"Aplicar filtros"})}),$("<button>",{class:"btn btn-warning",click:function(){r(),quickview.close(i)},html:A({en_us:"Clear",pt_br:"Limpar"})})]);var l=function(){for(var t=[],a=C.length,e=k.hits.total,s=k.aggregations,n=0;n<a;n++){var r,i,l=C[n],o="/"+window.location.hash+"/"+l._id;r=l.price?formatMoney(l.price,l.currency_id):A({en_us:"No price",pt_br:"Sem preço"}),i=l.quantity?l.quantity+" un":"∞";var c="";if(l.pictures&&l.pictures.length){var d=l.pictures[0],u=d.small;if(!u)for(var p in d)if(d.hasOwnProperty(p)&&"_id"!==p){u=d[p];break}u&&(c='<img src="'+u.url+'">')}var m=$("<input>",{class:"custom-control-input",type:"checkbox"}),f=$("<div>",{class:"col item-product",html:['<a href="'+o+'" class="item-picture">'+c+'</a><div class="item-info"><a href="'+o+'">'+l.name+'</a><div class="item-price">'+r+'</div><div class="item-qnt">'+i+"</div></div>",$("<div>",{class:"custom-controls-stacked",html:$("<div>",{class:"custom-control custom-checkbox",html:[m,$("<label>",{class:"custom-control-label text-monospace",text:l.sku})]})})]});t.push(f),function(a){m.on("change",function(){$(this).is(":checked")?M.selectedItems.push(a):M.selectedItems=$.grep(M.selectedItems,function(t){return t!==a})})}(l._id)}0===I?0<e?P.html($("<div>",{class:"row row-products",html:t})):P.html(""):P.children(".row").append(t),a<e?(j.removeAttr("disabled"),0===I&&(S=a)):j.attr("disabled",!0);var v=q.find("#products-list-info");0===e?v.hide():(v.show(),v.find("#products-list-count").text(S*I+a),v.find("#products-list-total").text(e),v.find("#products-avg-price").text(formatMoney(s.avg_price.value)+" ("+formatMoney(s.min_price.value)+" - "+formatMoney(s.max_price.value)+")")),N.html("");var h={"brands.name":{label:A({en_us:"Brands",pt_br:"Marcas"})},"categories.name":{label:A({en_us:"Categories",pt_br:"Categorias"})},status:{label:"Status"}};for(var b in h)if(h.hasOwnProperty(b)&&s.hasOwnProperty(b)){var g=h[b],_=s[b].buckets;if(_.length){var x="";for(n=0;n<_.length;n++){var y=_[n].key;x+='<option value="'+y+'" data-subtext="('+_[n].doc_count+')">'+y+"</option>"}var w=$("<select />",{multiple:!0,"data-live-search":!0,class:"form-control",name:b,html:x});N.prepend($("<div />",{class:"form-group selectpicker-default",html:w})),w.selectpicker({style:"btn-light",noneSelectedText:g.label,windowPadding:70})}}q.removeClass("ajax"),handleInputs(F,function(t,a){var e=t.attr("name"),s=t.data("opt"),n=t.data("filter")||"terms",r=t.val();Array.isArray(r)?r.length||(r=null):(r=t.data("is-number")?stringToNumber(r):"number"===t.attr("type")?parseFloat(r):r.trim(),(isNaN(r)||""===r)&&(r=null));for(var i=0;i<O.length;i++){var l=O[i][n];if(l&&l.hasOwnProperty(e))return void(s?null!==r?l[e][s]=r:(delete l[e][s],Object.keys(l[e]).length||O.splice(i,1)):null!==r?l[e]=r:O.splice(i,1))}if(null!==r){var o={};o[n]={},s?(o[n][e]={},o[n][e][s]=r):o[n][e]=r,O.push(o)}})},o=q.find("#search-products"),c=o.find("input");c.attr("placeholder",A({en_us:"Polo Shirt",pt_br:"Camisa Polo"})),o.submit(function(){s=c.val().trim(),a()}),q.find("#order-products a").click(function(){var t;$(this).hasClass("active")?(t="asc",$(this).find("i").removeClass("fa-caret-down text-warning").addClass("fa-caret-up text-info")):(t="desc",$(this).parent().children(".active").removeClass("active").find("i").remove(),$(this).addClass("active").append($("<i>",{class:"ml-1 fa fa-caret-down text-warning"}))),(n={})[$(this).data("field")]={order:t},a()}),M.deleteItems=function(){return q.addClass("ajax"),function(t){Array.isArray(t)&&!t.length?P.find("input:checked").closest(".item-product").fadeOut(400,function(){q.removeClass("ajax")}):a()}},l()}}();