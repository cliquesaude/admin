!function(){"use strict";var w,k,a=window.tabId,e=window.Tabs[a],M=$("#products-list-container"),q=M.find("#products-list-results"),P=M.find("#load-products"),C=window.i18n,n=function(){w=e.data,k=w.hits.hits.map(function(a){return Object.assign({_id:a._id},a._source)})};if(n(),k.length){var s="",O=[],j=0,A=0,t=function(a){var t;""!==s?(t={bool:{must:{multi_match:{query:s,fields:["name","keywords"]}}}},O.length&&(t.bool.filter=O)):O.length&&(t={bool:{filter:O}});M.addClass("ajax"),a?j++:j=0,e.load(function(){n(),i()},t,j)};P.click(function(){t(!0)});var S=$("<div>"),N=$("<form>",{action:"javascript:;",submit:t,html:['<div class="form-group"><input class="form-control text-monospace" placeholder="SKU" type="text" name="sku" data-filter="term"/></div>',S,'<label class="i18n"><span data-lang="en_us">Price</span><span data-lang="pt_br">Preço</span></label><div class="flexbox"><div class="form-group"><input class="form-control" type="tel" name="price" data-opt="gte" data-filter="range" data-is-number="true" data-money="true"/><small class="form-text i18n"><span data-lang="en_us">Minimun</span><span data-lang="pt_br">Mínimo</span></small></div><div class="form-group"><input class="form-control" type="tel" name="price" data-opt="lte" data-filter="range" data-is-number="true" data-money="true"/><small class="form-text i18n"><span data-lang="en_us">Maximum</span><span data-lang="pt_br">Máximo</span></small></div></div><label class="i18n"><span data-lang="en_us">Quantity</span><span data-lang="pt_br">Quantidade</span></label><div class="flexbox"><div class="form-group"><input class="form-control" type="number" name="quantity" data-opt="gte" data-filter="range" data-is-number="true"/><small class="form-text i18n"><span data-lang="en_us">Minimun</span><span data-lang="pt_br">Mínimo</span></small></div><div class="form-group"><input class="form-control" type="number" name="quantity" data-opt="lte" data-filter="range" data-is-number="true"/><small class="form-text i18n"><span data-lang="en_us">Maximum</span><span data-lang="pt_br">Máximo</span></small></div></div>']}),r=function(){O=[],t()};M.find("#clear-products-filters").click(r);var l=$("#qvx");l.find("#qvx-title").text(C({en_us:"Filter products",pt_br:"Filtrar produtos"})),l.find("#qvx-body").html(N),l.find("#qvx-footer").html([$("<button>",{class:"btn btn-success mr-2",click:function(){t(),quickview.close(l)},html:C({en_us:"Apply filters",pt_br:"Aplicar filtros"})}),$("<button>",{class:"btn btn-warning",click:function(){r(),quickview.close(l)},html:C({en_us:"Clear",pt_br:"Limpar"})})]);var i=function(){for(var a=[],t=k.length,e=w.hits.total,n=w.aggregations,s=0;s<t;s++){var r,l,i=k[s],o="/"+window.location.hash+"/"+i._id;r=i.price?formatMoney(i.price,i.currency_id):C({en_us:"No price",pt_br:"Sem preço"}),l=i.quantity?i.quantity+" un":"∞";var c="";if(i.pictures&&i.pictures.length){var d=i.pictures[0],u=d.small;if(!u)for(var p in d)if(d.hasOwnProperty(p)&&"_id"!==p){u=d[p];break}u&&(c='<img src="'+u.url+'">')}var m=$("<div />",{class:"col",html:'<a href="'+o+'" class="item-picture">'+c+'</a><div class="item-info"><a href="'+o+'">'+i.name+'</a><div class="item-price">'+r+'</div><div class="item-qnt">'+l+'</div></div><div class="custom-controls-stacked"><div class="custom-control custom-checkbox"><input type="checkbox" class="custom-control-input"><label class="custom-control-label text-monospace">'+i.sku+"</label></div></div>"});a.push(m)}0===j?0<e?q.html($("<div>",{class:"row row-products",html:a})):q.html(""):q.children(".row").append(a),t<e?(P.removeAttr("disabled"),0===j&&(A=t)):P.attr("disabled",!0);var f=M.find("#products-list-info");0===e?f.hide():(f.show(),f.find("#products-list-count").text(A*j+t),f.find("#products-list-total").text(e),f.find("#products-avg-price").text(formatMoney(n.avg_price.value)+" ("+formatMoney(n.min_price.value)+" - "+formatMoney(n.max_price.value)+")")),S.html("");var v={"brands.name":{label:C({en_us:"Brands",pt_br:"Marcas"})},"categories.name":{label:C({en_us:"Categories",pt_br:"Categorias"})},status:{label:"Status"}};for(var b in v)if(v.hasOwnProperty(b)&&n.hasOwnProperty(b)){var g=v[b],h=n[b].buckets;if(h.length){var _="";for(s=0;s<h.length;s++){var y=h[s].key;_+='<option value="'+y+'" data-subtext="('+h[s].doc_count+')">'+y+"</option>"}var x=$("<select />",{multiple:!0,"data-live-search":!0,class:"form-control",name:b,html:_});S.prepend($("<div />",{class:"form-group selectpicker-default",html:x})),x.selectpicker({style:"btn-light",noneSelectedText:g.label,windowPadding:70})}}M.removeClass("ajax"),handleInputs(N,function(a,t){var e=a.attr("name"),n=a.data("opt"),s=a.data("filter")||"terms",r=a.val();Array.isArray(r)?r.length||(r=null):(r=a.data("is-number")?stringToNumber(r):"number"===a.attr("type")?parseFloat(r):r.trim(),(isNaN(r)||""===r)&&(r=null));for(var l=0;l<O.length;l++){var i=O[l][s];if(i&&i.hasOwnProperty(e))return void(n?null!==r?i[e][n]=r:(delete i[e][n],Object.keys(i[e]).length||O.splice(l,1)):null!==r?i[e]=r:O.splice(l,1))}if(null!==r){var o={};o[s]={},n?(o[s][e]={},o[s][e][n]=r):o[s][e]=r,O.push(o)}})},o=M.find("#search-products"),c=o.find("input");c.attr("placeholder",C({en_us:"Polo Shirt",pt_br:"Camisa Polo"})),o.submit(function(){s=c.val().trim(),t()}),i()}}();