!function(){"use strict";var i=window.tabId,l=window.Tabs[i],s=$("#t"+i+"-tab-normal");window.renderContentIds(s);var c=window.i18n,d="/"+window.location.hash+"/";$("#t"+i+"-create").click(function(){window.location=d+"new"});var t,u,f=l.slug,p=function(){t=l.data,u=t.result.map(function(t,e){var n={_index:e};for(var i in t){var a=t[i];if("object"!=typeof a||null===a||Array.isArray(a))n[i]=a;else for(var r in a)a.hasOwnProperty(r)&&(n[i+"/"+r]=a[r])}return n})};if(p(),u.length){var v,a='<div class="custom-controls-stacked"><div class="custom-control custom-checkbox"><input type="checkbox" class="custom-control-input" /><label class="custom-control-label"> </label></div></div>',h=$("#t"+i+"-resource-list"),m=0,g=0;v=t.meta.hasOwnProperty("limit")?t.meta.limit:1e3;var w={},b="updated_at",k="desc",T={field:b,order:k},r=function(t){("number"!=typeof t||isNaN(t)||t<1)&&(t=1),g=(t-1)*v,D()},e=function(t){var e=$("#t"+i+"-page"),n=parseInt(e.val(),10)+t;0<n&&(r(n),e.val(n))},x=function(){var t=$("#t"+i+"-prev"),e=$("#t"+i+"-next"),n=$("#t"+i+"-page");g<=0?t.attr("disabled",!0):t.removeAttr("disabled"),u.length<v?e.attr("disabled",!0):e.removeAttr("disabled"),g<=0&&u.length<v?n.attr("disabled",!0):n.removeAttr("disabled"),n.val(Math.ceil(g/v)+1)};$("#t"+i+"-page").keydown(window.keyIsNumber).change(function(){r(parseInt($(this).val(),10))}),$("#t"+i+"-next").click(function(){e(1)}),$("#t"+i+"-prev").click(function(){e(-1)}),x(),l.pagination=function(t){e(t?-1:1)},$("#t"+i+"-page-size").change(function(){var t=parseInt($(this).val(),10);!isNaN(t)&&0<t&&(v=t,g=0,$("#t"+i+"-page").val("1")),D()});var y=!1,_=!1,I=!1,j=!1,D=function(e){if(I)j||(j=!0);else{var n;I=!0,e||(n=h.find(".loading")).show();var t="limit="+v;0<g&&(t+="&offset="+g),T.field&&(t+="&sort=","desc"===T.order&&(t+="-"),t+=T.field.replace("/","."));for(var i=0;i<O.length;i++){var a=O[i],r=w[a];if(r&&""!==r){var o=a.replace("/",".");/([0-9]+)?>>([0-9]+)?/.test(r)?(""!==(r=r.split(">>"))[0]&&(t+="&"+o+">="+r[0]),""!==r[1]&&(t+="&"+o+"<="+r[1])):t+="&"+o+"="+r}}l.load(function(t){I=!1,"function"!=typeof e?(n.fadeOut(),j&&(D(),j=!1),t||(p(),y=!0,h.jsGrid("loadData"),x())):e()},t)}},N=[{align:"center",css:"data-list-check",filtering:!1,sorting:!1,headerTemplate:function(){var t=$(a);return t.find("input").addClass("checkbox-all").on("change",function(){var t=$(this).is(":checked")?":not(:checked)":":checked";return setTimeout(function(){h.find(".data-list-check input"+t).next().click()},50),!0}),t},filterTemplate:function(){return'<div class="spinner-circle-shadow loading"></div>'},itemTemplate:function(t,e){var n=$(a),i=e._id;return n.find("input").on("change",function(){$(this).is(":checked")?o(i):A(i)}),n}}],O=[];$.getJSON("json/misc/config_lists.json",function(t){var e=t[f];if(e)for(var n=function(t,e){t.filterTemplate=function(){var n=$("<input>",{type:"hidden"}),t=function(){var t=stringToNumber(i.val())||"",e=stringToNumber(a.val())||"";n.val(""!==t||""!==e?t+">>"+e:""),h.jsGrid("loadData")};this.filterControl=n;var i=$("<input>",{change:t,type:"tel",placeholder:c({en_us:"min",pt_br:"mín"})}),a=$("<input>",{change:t,type:"tel",placeholder:c({en_us:"max",pt_br:"máx"})});return e&&(i.inputMoney(!0),a.inputMoney(!0)),$("<div>",{html:[i,a]})}},i=0;i<e._fields.length;i++){var a=e._fields[i],r=e[a]||{};O.push(a);var o={name:a,type:"text",title:c(r.label||t._labels[a])};if(0===i)o.itemTemplate=function(t,e){if(t&&e)return $("<a>",{text:t,href:d+e._id})};else switch(r.type){case"link":o.itemTemplate=function(t){if(t){var e=t.length;return $("<a>",{text:32<e?t.substr(0,12)+"..."+t.substr(e-20):t,href:t,target:"_blank"})}};break;case"bold":!function(t,i,a){var r=function(t){var e=a[t]||{},n=i+" text-"+(e.class||"muted");return $("<span>",{class:n,text:c(e.text)||t})};o.itemTemplate=function(t){if(t)return r(t)},o.filterTemplate=function(){var t=[$("<option>",{text:"--",value:"",selected:!0})];for(var e in a)a.hasOwnProperty(e)&&t.push($("<option>",{text:e,value:e,"data-content":r(e).prop("outerHTML")}));var n=$("<select>",{class:"hidden",html:t,change:function(){h.jsGrid("loadData")}});return this.filterControl=n,setTimeout(function(){n.selectpicker({noneSelectedText:"--",windowPadding:70,container:s})},200),n}}(0,r.type,r.enum);break;case"money":o.itemTemplate=o.itemTemplate=function(t){return formatMoney(t)},n(o,!0)}r.width&&(o.css="data-list-fixed",o.width=r.width),r.range&&n(o),N.push(o),w[a]=""}N.push({name:"updated_at",type:"text",title:c(t._labels.updated_at),filtering:!1,itemTemplate:function(t){return t?formatDate(t):t}},{css:"data-list-control",filtering:!1,sorting:!1,title:"#",filterTemplate:function(){return $("<div>",{class:"data-list-control-buttons",html:[$("<i>",{class:"fa fa-search",click:function(){h.jsGrid("loadData")}}),$("<i>",{class:"fa fa-filter",click:function(){h.jsGrid("clearFilter")}})]})},itemTemplate:function(){return"#"+(g+ ++m)}}),h.jsGrid({autoload:!0,filtering:!0,sorting:!0,confirmDeleting:!1,pageLoading:!0,pageSize:v,rowClick:function(t){var e=t.event.originalEvent||t.event;if(e){var n=e.target;if(n)switch(n.nodeName){case"TD":for(var i=0;i<n.classList.length;i++)if("data-list-check"===n.classList[i])return void $(n).find("label").click();break;case"LABEL":case"INPUT":case"DIV":case"SELECT":case"A":return}}var a=t.item;window.location=d+a._id,v=1,l.state.page=g+a._index,l.state.pagination=function(t){-1<(g=l.state.page+(t?-1:1))&&(l.state.page=g,D(function(){var t=l.data.result;t&&t.length&&(window.location=d+t[0]._id)}))}},controller:{loadData:function(t){if(y)y=!1;else if(_)D();else{var e=!1;for(var n in w)w.hasOwnProperty(n)&&t[n]!==w[n]&&(w[n]=t[n],e||(e=!0));t.sortField||(t.sortField=b,t.sortOrder=k),T.field===t.sortField&&T.order===t.sortOrder||(T.field=t.sortField,T.order=t.sortOrder,e||(e=!0)),e&&(g=0,x(),D())}return{data:u,itemsCount:u.length}}},onRefreshing:function(){m=0},fields:N})});var o=function(t){l.selectedItems.push(t)},A=function(e){l.selectedItems=$.grep(l.selectedItems,function(t){return t!==e})};l.deleteItems=function(){return h.find(".loading").show(),function(){y=!(_=!0),h.jsGrid("loadData"),h.find(".checkbox-all:checked").next().click()}}}setTimeout(function(){window.unsetSaveAction()},200)}();