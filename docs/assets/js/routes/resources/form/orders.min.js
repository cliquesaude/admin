!function(){"use strict";var f=window.i18n,m=window.tabId,n=window.Tabs[m],l=n.commit,d=function(){return n.data},a=function(){var a=d(),u=$("#t"+m+"-order-base"),n=u.find("#t"+m+"-order-amount"),e=n.find('input[name="amount.total"]');n.find('input:not([name="amount.total"])').change(function(){setTimeout(function(){var n=d().amount,a=(n.subtotal||0)+(n.freight||0)-(n.discount||0);n.tax&&(a+=n.tax),n.extra&&(a+=n.extra),e.val(formatMoney(0<=a?a:0)).trigger("change")},150)});var t,s,i=n.find("#t"+m+"-extra-amount"),r=function(){i.children("div").slideToggle()};i.children("a").click(r),a.amount&&(a.amount.tax||a.amount.extra)&&r(),setTimeout(function(){if(t=u.find("#t"+m+"-order-buyers"),s=t.find("#t"+m+"-buyer-info"),a.buyers)for(var n=0;n<a.buyers.length;n++)o(a.buyers[n])},200);var o=function(n){var a,t=n._id,e="";if(n.main_email&&(e+='<a href="mailto:'+n.main_email+'" target="_blank">'+n.main_email+"</a>"),n.name?(a=n.name.given_name,n.name.middle_name&&(a+=" "+n.name.middle_name),n.name.family_name&&(a+=" "+n.name.family_name),n.display_name&&(a+=" ("+n.display_name+")")):n.display_name&&(a=n.display_name),a&&(e+="<br>"+a),n.phones)for(var i=0;i<n.phones.length;i++)e+='<br><span class="text-muted">'+n.phones[i].number+"</span>";var r=$("<i>",{class:"py-10 pr-10 remove fa fa-trash"}).click(function(){for(var n=d(),a=n.buyers,e=0;e<a.length;e++){if(a[e]._id===t){a.splice(e,1),l(n,!0);break}}o.slideUp(300,function(){$(this).remove()})}),o=$("<div>",{class:"hidden mb-3",html:[r,e]});s.append(o),o.slideDown()};$.getJSON("json/misc/config_lists.json",function(n){for(var a=["status","financial_status/current","fulfillment_status/current"],e=0;e<a.length;e++){var t=a[e],i=t.replace("/","."),r=[],o=n.orders[t].enum;for(var s in o)o.hasOwnProperty(s)&&r.push($("<option>",{value:s,text:s,"data-content":'<span class="text-'+o[s].class+'">'+f(o[s].text)+"</span>"}));var m=u.find('select[name="'+i+'"]');m.html(r);var l=getFromDotNotation(d(),i);l&&m.val(l),m.selectpicker("refresh")}})};n.$form?a():$(document).one("form-"+m,a)}();