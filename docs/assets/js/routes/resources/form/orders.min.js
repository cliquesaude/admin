!function(){"use strict";var u=window.tabId,n=window.Tabs[u],s=n.commit,l=function(){return n.data},a=function(){var a=l(),e=$("#t"+u+"-order-base"),n=e.find("#t"+u+"-order-amount"),t=n.find('input[name="amount.total"]');n.find('input:not([name="amount.total"])').change(function(){setTimeout(function(){var n=l().amount,a=(n.subtotal||0)+(n.freight||0)-(n.discount||0);n.tax&&(a+=n.tax),n.extra&&(a+=n.extra),t.val(formatMoney(0<=a?a:0)).trigger("change")},150)});var i,o,m=n.find("#t"+u+"-extra-amount"),r=function(){m.children("div").slideToggle()};m.children("a").click(r),a.amount&&(a.amount.tax||a.amount.extra)&&r(),setTimeout(function(){if(i=e.find("#t"+u+"-order-buyers"),o=i.find("#t"+u+"-buyer-info"),a.buyers)for(var n=0;n<a.buyers.length;n++)d(a.buyers[n])},200);var d=function(n){var a,t=n._id,e="";if(n.main_email&&(e+='<a href="mailto:'+n.main_email+'" target="_blank">'+n.main_email+"</a>"),n.name?(a=n.name.given_name,n.name.middle_name&&(a+=" "+n.name.middle_name),n.name.family_name&&(a+=" "+n.name.family_name),n.display_name&&(a+=" ("+n.display_name+")")):n.display_name&&(a=n.display_name),a&&(e+="<br>"+a),n.phones)for(var i=0;i<n.phones.length;i++)e+='<br><span class="text-muted">'+n.phones[i].number+"</span>";var m=$("<i>",{class:"py-10 pr-10 remove fa fa-trash"}).click(function(){for(var n=l(),a=n.buyers,e=0;e<a.length;e++){if(a[e]._id===t){a.splice(e,1),s(n,!0);break}}r.slideUp(300,function(){$(this).remove()})}),r=$("<div>",{class:"hidden mb-3",html:[m,e]});o.append(r),r.slideDown()}};n.$form?a():$(document).one("form-"+u,a)}();