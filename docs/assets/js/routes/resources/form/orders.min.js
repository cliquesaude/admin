!function(){"use strict";var n=window.tabId,a=window.Tabs[n],o=a.commit,d=function(){return a.data},e=d(),t=$("#t"+n+"-order-base"),i=t.find("#t"+n+"-order-amount"),m=i.find('input[name="amount.total"]');i.find('input:not([name="amount.total"])').change(function(){setTimeout(function(){var a=d().amount,n=(a.subtotal||0)+(a.freight||0)-(a.discount||0);a.tax&&(n+=a.tax),a.extra&&(n+=a.extra),m.val(formatMoney(0<=n?n:0)).trigger("change")},150)});var r,s,l=i.find("#t"+n+"-extra-amount"),u=function(){l.children("div").slideToggle()};l.children("a").click(u),e.amount&&(e.amount.tax||e.amount.extra)&&u(),setTimeout(function(){if(r=t.find("#t"+n+"-order-buyers"),s=r.find("#t"+n+"-buyer-info"),e.buyers)for(var a=0;a<e.buyers.length;a++)f(e.buyers[a])},200);var f=function(a){var n,t=a._id,e="";if(a.main_email&&(e+='<a href="mailto:'+a.main_email+'" target="_blank">'+a.main_email+"</a>"),a.name?(n=a.name.given_name,a.name.middle_name&&(n+=" "+a.name.middle_name),a.name.family_name&&(n+=" "+a.name.family_name),a.display_name&&(n+=" ("+a.display_name+")")):a.display_name&&(n=a.display_name),n&&(e+="<br>"+n),a.phones)for(var i=0;i<a.phones.length;i++)e+='<br><span class="text-muted">'+a.phones[i].number+"</span>";var m=$("<i>",{class:"py-10 pr-10 remove fa fa-trash"}).click(function(){for(var a=d(),n=a.buyers,e=0;e<n.length;e++){if(n[e]._id===t){n.splice(e,1),o(a,!0);break}}r.slideUp(300,function(){$(this).remove()})}),r=$("<div>",{class:"hidden mb-3",html:[m,e]});s.append(r),r.slideDown()}}();