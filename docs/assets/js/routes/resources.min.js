!function(){"use strict";var i=window.tabId,o=window.Tabs[i];window.renderContentIds();var r=window.routeParams[0];if(void 0!==r){var e=window.apiResources[r];if(void 0!==e){var t,n,a,s,d,l=window.lang,c=window.i18n,u=window.routeParams[1];void 0===u?(t=c({en_us:"List",pt_br:"Listar"}),n=e.label[l],s=!0):("new"===u?(t=c({en_us:"Create",pt_br:"Criar"}),a=!(u=void 0)):t=c({en_us:"Edit",pt_br:"Editar"}),n=e.label[l]+" · "+t),d="<strong>"+e.label[l]+"</strong> · "+t,$("#t"+i+"-resource-name").html(d),d='<li class="breadcrumb-item"><a href="/#/resources/'+r+'"><i class="fa fa-'+e.icon+'"></i> '+e.label[l]+'</a></li><li class="breadcrumb-item active">'+t+"</li>",$("#t"+i+"-breadcrumbs").append(d);var f=ace.edit("t"+i+"-code-editor");f.setTheme("ace/theme/dawn"),f.session.setMode("ace/mode/json"),$("#t"+i+"-code-tab").click(function(){setTimeout(function(){f.focus(),f.renderer.updateFull()},200)});var m=function(e){var t;e||(!0===s?t="products"!==r?"routes/resources/list.html":"routes/resources/list/products.html":(t="routes/resources/form/"+r+".html",o.commit=w,f.on("blur",function(){var e;try{e=JSON.parse(f.session.getValue())}catch(e){return}o.data=e}),f.on("change",function(){window.triggerUnsaved(i)})),window.loadContent(t,$("#t"+i+"-tab-normal")));window.routeReady(n)},w=function(e,t){t||(o.data=e),f.session.setValue(JSON.stringify(e,null,4))};if(o.resourceId=u,o.slug=r,!0!==a){var p,v,g;if(void 0===u)if(f.setReadOnly(!0),"products"===r){var b={sort:[{available:{order:"desc"}},"_score",{ad_relevance:{order:"desc"}},{_id:{order:"desc"}}],aggs:{"brands.name":{terms:{field:"brands.name"}},"categories.name":{terms:{field:"categories.name"}},status:{terms:{field:"status"}},min_price:{min:{field:"price"}},max_price:{max:{field:"price"}},avg_price:{avg:{field:"price"}}},size:30};v=function(i,e,t,n,a){var s;s=e?Object.assign({query:e},b):b,t&&(4<s.sort.length?s.sort[2]=t:s.sort.splice(2,0,t)),a&&(s.size=a),s.from=n?s.size*n:0,window.callSearchApi("items.json","POST",function(e,t){e||w(t),"function"==typeof i&&i(null,t)},s)}}else p=r+".json",g="limit=60";else if(p=r+"/"+u+".json",o.state.pagination){var h=$("#t"+i+"-pagination-next"),_=$("#t"+i+"-pagination-prev");0===o.state.page&&_.addClass("disabled"),o.pagination=o.state.pagination,_.click(function(){$(this).addClass("disabled"),o.pagination(!0)}),h.click(function(){$(this).addClass("disabled"),o.pagination()}).closest(".pagination-arrows").fadeIn()}v||(v=function(i,e){var t=p;e&&(t+="?"+e),window.callApi(t,"GET",function(e,t){e||(void 0!==u&&(delete t._id,delete t.store_id,delete t.created_at,delete t.updated_at),w(t)),"function"==typeof i&&i(null,t)})}),o.load=v,$("#t"+i+"-new").fadeIn().click(function(){window.location="/"+window.location.hash+"/new"}),o.selectedItems=[],o.deleteItems=function(){return function(){}},$("#t"+i+"-delete").fadeIn().click(function(){var t=o.selectedItems.length;if(0<t){var i=o.deleteItems(),n=0,a=[],s=function(){var e=o.selectedItems[n];window.callApi(r+"/"+e+".json","DELETE",function(e){e&&a.push(e),++n===t?("function"==typeof i&&i(a),o.selectedItems=[]):s()})};s()}else u||app.toast(c({en_us:"No items selected to delete",pt_br:"Nenhum item selecionado para deletar"}))}),v(m,g)}else w({}),m()}else window.e404()}else window.e404()}();